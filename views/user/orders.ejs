<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shoes Store Website</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css" integrity="sha256-2XFplPlrFClt0bIdPgpz8H7ojnk10H69xRqd9+uTShA=" crossorigin="anonymous" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/orders.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css1/userlogin.css">
</head>
<body>

    <%- include('../partials/header.ejs') %>
    
<div class="container-xl px-4 mt-4">
    <!-- Account page navigation-->
    <nav class="nav nav-borders">
        <a class="nav-link  ms-0" href="/profile" target="__blank">Profile</a>
        <a class="nav-link active" href="/orders" target="__blank">Orders</a>
        <a class="nav-link" href="/changepassword" target="__blank">Change Password</a>
        <a class="nav-link" href="/address" target="__blank">Saved Addresses</a>
    </nav>
    <hr class="mt-0 mb-4">

    <!-- Billing history card-->
    <div class="card mb-4">
        <div class="card-header font-weight-bolder">Order History</div>
        <div class="card-body p-0">
            <!-- Billing history table-->
            <div class="table-responsive table-billing-history">
                <table class="table mb-0">
                    <thead>
                        <tr>
                            <th class="border-gray-200" scope="col">Order ID</th>
                            <th class="border-gray-200" scope="col">product</th>
                            <th class="border-gray-200" scope="col">Date</th>
                            <th class="border-gray-200" scope="col">Amount</th>
                            <th class="border-gray-200" scope="col">Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% orders.forEach(order=> {  %>
                        <tr>
                            <td class="table-data">#<%= order._id.toString().slice(0, 9) %></td>
                            <td>
                                <% order.products.forEach(product => { %>
                                    <a href="/orderdetails/<%= product.productId._id %>">
                                      <img src="/uploads/<%= product.productId.image[0] %>" style="width:80px; height:80px;">
                                    </a>
                                    <h6><%= product.productId.productName %></h6>
                                  <% }) %>                      
                            </td>
                            <td class="table-data"><%= order.orderDate ? order.orderDate.toISOString().split('T')[0] : '' %></td>
                            <td class="table-data">â‚¹<%= order.totalPrice %></span></td>
                            <td class="table-data"><%= order.orderStatus %></td>
                        </tr>
                        <% }) %>
                    </tbody>
                </table>
                <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center">
                      <% for (let i = 1; i <= totalPages; i++) { %>
                        <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                          <a class="page-link" href="/orders?page=<%= i %>"><%= i %></a>
                        </li>
                      <% } %>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>
</body>
</html>