<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shoes Store Admin</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css1/adminlogin.css">
</head>
<body>
    <%- include('../partials/adminheader.ejs') %>

    <section class="first-footer" style="border-bottom: 2px solid #000;">
        <footer class="text-center text-white" style="background-color: #ffffff;">
          <div class="container p-4 pb-0">
            <section class="">
              <p class="d-flex justify-content-center text-nowrap">
                <span class="me-3" style="color:black; font-weight:bold; font-size:200%; margin-right: 1030px; margin-top: 15px;">ADMIN/DASHBOARD</span>
              </p>
            </section>
          </div>
        </footer>
    </section>
    
    
        
    <div class="row flex-nowrap">
      <!-- Include the sidebar -->
      <%- include('../partials/adminsidebar.ejs') %>
  
      <div class="ml-5" style="width: 350px; height:250px;">
          <div class="total-stat with-box-shadow mt-3">
              <h4>TOTAL USERS</h4>
              <p class="font-weight-bold" id="totalUsersCount"><%= usersCount %></p>
          </div>
          <div class="mt-5" style="width: 350px;">
            <canvas id="myChart1"></canvas>
          </div>
          <div class="date-filter">
            <div class="row">
                <div class="col-md-6">
                    <div class="mt-4 form-group">
                        <label for="startDate" class="font-weight-bold">Start Date</label>
                        <input class="with-box-shadow" type="date" id="startDate" name="startDate">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mt-4 form-group">
                        <label for="endDate" class="font-weight-bold">End Date</label>
                        <input class="with-box-shadow" type="date" id="endDate" name="endDate">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 text-center">
                    <button class="btn btn-dark">Download Sales Report</button>
                </div>
            </div>
          </div>
      </div>
      <div class="ml-5" style="width: 350px; height:250px;">
          <div class="total-stat with-box-shadow mt-3">
              <h4>TOTAL ORDERS</h4>
              <p class="font-weight-bold" id="totalOrdersCount"><%= orderCount %></p>
          </div>
          <div class="ml-5 mt-5" style="width: 700px;">
            <canvas id="myChart2"></canvas>
          </div>
      </div>
      <div class="ml-5" style="width: 350px; height:250px;">
          <div class="total-stat with-box-shadow mt-3">
              <h4>TOTAL REVENUE</h4>
              <p class="font-weight-bold" id="totalRevenueAmount">â‚¹<%= totalRevenue %></p>
          </div>
      </div>
    </div>
  
  

          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

          <script>


        fetch('/usersgraph')
         .then((response)=>response.json())
         .then((data)=>{
            const ctx1 = document.getElementById('myChart1');
            new Chart(ctx1, {
              type: 'pie',
              data: {
                labels: ['Wallet', 'Online Payment','Cash on delivery'],
                datasets: [{
                  label: '',
                  data: [data.walletPayment,data.onlinePayment,data.cashOnDelivery],
                  backgroundColor: [
                  'rgba(245, 30, 95, 0.8)',
                  'rgba(13, 92, 216, 0.8)',
                  'rgba(13, 216, 104, 0.8)'
                  ],
                  borderWidth: 1
                }]
              },
              
            });
          })
          .catch((error)=>{
            console.error('Error fetching user stats:',error)
          })

        
          const ctx2 = document.getElementById('myChart2');
            new Chart(ctx2, {
              type: 'bar',
              data: {
                labels: ['jan','feb'],
                datasets: [{
                  label: 'Revenue',
                  data: [4000,6000],
                  backgroundColor: [
                  'rgba(255, 99, 132, 01)'
                  ],
                  borderWidth: 1
                }]
              },
              
            });
          


          </script>

    
      <%- include('../partials/adminfooter.ejs') %>