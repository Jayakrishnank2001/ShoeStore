<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Shoes Store Website</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet">

    <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.css">
    
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">

    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/ionicons.min.css">

    <link rel="stylesheet" href="css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="css/jquery.timepicker.css">

	<link rel="stylesheet" href="css1/userlogin.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/icomoon.css">
    <link rel="stylesheet" href="css/style.css">
  </head>
  <body class="goto-here">
    
    <%- include('../partials/header.ejs') %>

    <section class="ftco-section bg-light">
    	<div class="container">
    		<div class="row">
    			<div class="col-md-8 col-lg-10 order-md-last">
    				<div class="row">
						<% products.forEach(product => { %>
						<% if (product.isActive && product.gender==="men") { %>
		    			<div class="col-sm-12 col-md-12 col-lg-4 ftco-animate d-flex">
		    				<div class="product d-flex flex-column">
		    					<a href="/userproduct/<%= product._id %>" class="img-prod"><img class="img-fluid" src="uploads/<%= product.image %>" alt="Colorlib Template">
		    						<div class="overlay"></div>
		    					</a>
		    					<div class="text py-3 pb-4 px-3" style="margin-top: 56px;">
		    						<div class="d-flex">
		    							<div class="cat" style="font-weight: bolder;">
				    						<span><%= product.category.categoryName %></span>
				    					</div>
				    					<div class="rating">
			    							<p class="text-right mb-0">
			    								<a href="#"><span class="ion-ios-star-outline"></span></a>
			    								<a href="#"><span class="ion-ios-star-outline"></span></a>
			    								<a href="#"><span class="ion-ios-star-outline"></span></a>
			    								<a href="#"><span class="ion-ios-star-outline"></span></a>
			    								<a href="#"><span class="ion-ios-star-outline"></span></a>
			    							</p>
			    						</div>
			    					</div>
		    						<h3><a href="#"><%= product.productName %></a></h3>
									<div class="cat">
										<span style="color: black;"><%= product.gender %></span>
									</div>
		    						<div class="pricing">
			    						<p class="price"><span>â‚¹<%= product.price %></span></p>
			    					</div>
			    					<p class="bottom-area d-flex px-3">
		    							<a href="#" class="add-to-cart text-center py-2 mr-1" onclick="addToCart('<%= product._id %>')">
											<span>Add to cart <i class="ion-ios-add ml-1"></i></span>
										</a>
		    							<a href="#" class="buy-now text-center py-2">Buy now<span><i class="ion-ios-cart ml-1"></i></span></a>
		    						</p>
		    					</div>
		    				</div>
		    			</div>
						<% } %>
						<% }); %>
		    		</div>
					<div class="row mt-5">
						<div class="col text-center">
						  <div class="block-27">
							<ul>
							  <% if (currentPage > 1) { %>
								<li><a href="/products?page=<%= currentPage - 1 %>&priceFrom=<%= priceFrom %>&priceTo=<%= priceTo %>">&lt;</a></li>
							  <% } %>
							  <% for (let i = 1; i <= totalPages; i++) { %>
								<li class="<%= i === currentPage ? 'active' : '' %>">
								  <a href="/products?page=<%= i %>&priceFrom=<%= priceFrom %>&priceTo=<%= priceTo %>"><span><%= i %></span></a>
								</li>
							  <% } %>
							  <% if (currentPage < totalPages) { %>
								<li><a href="/products?page=<%= currentPage + 1 %>&priceFrom=<%= priceFrom %>&priceTo=<%= priceTo %>">&gt;</a></li>
							  <% } %>
							</ul>
						  </div>
						</div>
					  </div>
					  
		    	</div>

		    	<div class="col-md-4 col-lg-2">
		    		<div class="sidebar">
							<div class="sidebar-box-2">
								<h2 class="heading">Categories</h2>
								<div class="fancy-collapse-panel">
									<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
										<div class="panel panel-default">
											<div class="panel-heading" role="tab" id="headingTwo">
												<h4 class="panel-title">
													<a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Men's Shoes
													</a>
												</h4>
											</div>
											<div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
												<div class="panel-body">
													<% categories.forEach(category => { %>
														<% if (category.isActive) { %>
															<ul>
																<li><a href="/products?categoryId=<%= category._id %>"><%= category.categoryName %></a></li>
															</ul>
														<% } %>
													<% }); %>
												</div>												
											</div>
										</div>
									 </div>
                                </div>
							</div>
							<div class="sidebar-box-2">
							<h2 class="heading">Price Range</h2>
							<form method="get" id="price-filter-form" class="colorlib-form-2">
		              <div class="row">
		                <div class="col-md-12">
							<div class="form-group">
							  <label for="priceFrom">Price from:</label>
							  <div class="form-field">
								<i class="icon icon-arrow-down3"></i>
								<select name="priceFrom" id="priceFrom" class="form-control">
								  <option value=""></option>
								  <option value="100">100</option>
								  <option value="200">200</option>
								  <option value="300">300</option>
								  <option value="400">400</option>
								  <option value="1000">1000</option>
								</select>
							  </div>
							</div>
						  </div>
						  <div class="col-md-12">
							<div class="form-group">
							  <label for="priceTo">Price to:</label>
							  <div class="form-field">
								<i class="icon icon-arrow-down3"></i>
								<select name="priceTo" id="priceTo" class="form-control">
								  <option value=""></option>
								  <option value="2000">2000</option>
								  <option value="3000">3000</option>
								  <option value="4000">4000</option>
								  <option value="5000">5000</option>
								  <option value="6000">6000</option>
								</select>
							  </div>
							</div>
						  </div>
						  <div class="col-md-12">
							<div class="form-group">
								<button type="button" id="filterButton" class="btn btn-dark btn-block">APPLY</button>
							</div>
						</div>
		              </div>
		            </form>
							</div>
						</div>
    			</div>
    		</div>
    	</div>
    </section>
		
		<section class="ftco-gallery">
    	<div class="container">
    		<div class="row justify-content-center">
    			<div class="col-md-8 heading-section text-center mb-4 ftco-animate">
            <h2 class="mb-4">Follow Us On Instagram</h2>
            <p>Follow us on Instagram,Facebook and Twitter for more updates. Follow us on Instagram,Facebook and all other major social media platforms.</p>
          </div>
    		</div>
    	</div>
    	<div class="container-fluid px-0">
    		<div class="row no-gutters">
					<div class="col-md-4 col-lg-2 ftco-animate">
						<a href="images/gallery-1.jpg" class="gallery image-popup img d-flex align-items-center" style="background-image: url(images/gallery-1.jpg);">
							<div class="icon mb-4 d-flex align-items-center justify-content-center">
    						<span class="icon-instagram"></span>
    					</div>
						</a>
					</div>
					<div class="col-md-4 col-lg-2 ftco-animate">
						<a href="images/gallery-2.jpg" class="gallery image-popup img d-flex align-items-center" style="background-image: url(images/gallery-2.jpg);">
							<div class="icon mb-4 d-flex align-items-center justify-content-center">
    						<span class="icon-instagram"></span>
    					</div>
						</a>
					</div>
					<div class="col-md-4 col-lg-2 ftco-animate">
						<a href="images/gallery-3.jpg" class="gallery image-popup img d-flex align-items-center" style="background-image: url(images/gallery-3.jpg);">
							<div class="icon mb-4 d-flex align-items-center justify-content-center">
    						<span class="icon-instagram"></span>
    					</div>
						</a>
					</div>
					<div class="col-md-4 col-lg-2 ftco-animate">
						<a href="images/gallery-4.jpg" class="gallery image-popup img d-flex align-items-center" style="background-image: url(images/gallery-4.jpg);">
							<div class="icon mb-4 d-flex align-items-center justify-content-center">
    						<span class="icon-instagram"></span>
    					</div>
						</a>
					</div>
					<div class="col-md-4 col-lg-2 ftco-animate">
						<a href="images/gallery-5.jpg" class="gallery image-popup img d-flex align-items-center" style="background-image: url(images/gallery-5.jpg);">
							<div class="icon mb-4 d-flex align-items-center justify-content-center">
    						<span class="icon-instagram"></span>
    					</div>
						</a>
					</div>
					<div class="col-md-4 col-lg-2 ftco-animate">
						<a href="images/gallery-6.jpg" class="gallery image-popup img d-flex align-items-center" style="background-image: url(images/gallery-6.jpg);">
							<div class="icon mb-4 d-flex align-items-center justify-content-center">
    						<span class="icon-instagram"></span>
    					</div>
						</a>
					</div>
        </div>
    	</div>
    </section>

	<script>
  

         // Add an event listener to the "Filter" button
    const filterButton = document.getElementById('filterButton');
    filterButton.addEventListener('click', filterProducts);

    // Function to handle the filtering logic
    function filterProducts() {
        const priceFromSelect = document.getElementById('priceFrom');
        const priceToSelect = document.getElementById('priceTo');

        const priceFrom = priceFromSelect.value;
        const priceTo = priceToSelect.value;

        // Redirect to the filtered products page with the selected price range
        window.location.href = `/products?priceFrom=${priceFrom}&priceTo=${priceTo}`;
    }


	function addToCart(productId) {
    try {
        const response = fetch(`/addCart/${productId}`, {
            method: 'POST',
        });

        if (response.ok) {
            // Product added to cart successfully
            console.log('Product added to cart');
        } else {
            // Handle error response (e.g., product not found or unauthorized)
            const data = response.json();
            console.error('Error:', data.error);
        }
    } catch (error) {
        console.error('Error:', error);
    }
   }


	</script>
	  


    <%- include('../partials/homefooter.ejs') %>